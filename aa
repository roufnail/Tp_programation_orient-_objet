def vigenere(texte, cle, mode='chiffrement'):
    """
    Chiffre ou déchiffre un texte avec le chiffrement de Vigenère.
    Args:
        texte: Le texte à traiter
        cle: La clé (lettres seulement)
        mode: 'chiffrement' ou 'dechiffrement'
    """
    resultat = []
    cle_repetee = (cle.upper() * (len(texte) // len(cle) + 1))[:len(texte)]
    index_cle = 0

    for caractere in texte:
        if caractere.isalpha():
            # Déterminer le décalage
            decalage = ord(cle_repetee[index_cle]) - ord('A')
            if mode == 'dechiffrement':
                decalage = -decalage

            # Appliquer le décalage
            base = ord('A') if caractere.isupper() else ord('a')
            nouveau_car = chr((ord(caractere) - base + decalage) % 26 + base)
            resultat.append(nouveau_car)
            index_cle += 1
        else:
            # Conserver les caractères non alphabétiques
            resultat.append(caractere)

    return ''.join(resultat)

def main():
    print("=== Chiffrement de Vigenère ===")
    print("(La clé sera répétée pour correspondre au texte)\n")

    while True:
        print("\nOptions:")
        print("1. Chiffrer un message")
        print("2. Déchiffrer un message")
        print("3. Quitter")

        choix = input("Votre choix (1-3): ")

        if choix == '1':
            texte = input("Message à chiffrer: ")
            cle = input("Clé (lettres seulement): ")
            if not cle.isalpha():
                print("Erreur: La clé ne doit contenir que des lettres")
                continue
            print("Résultat:", vigenere(texte, cle, 'chiffrement'))

        elif choix == '2':
            texte = input("Message à déchiffrer: ")
            cle = input("Clé utilisée: ")
            if not cle.isalpha():
                print("Erreur: La clé ne doit contenir que des lettres")
                continue
            print("Résultat:", vigenere(texte, cle, 'dechiffrement'))

        elif choix == '3':
            print("Au revoir!")
            break

        else:
            print("Choix invalide. Veuillez choisir 1, 2 ou 3.")

if __name__ == "__main__":
    main()